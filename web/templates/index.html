{% extends "base.html" %}

{% block title %}Live View - OptiVue{% endblock %}

{% block page_title %}Live View{% endblock %}

<style>
    /* Video Feed Area */
    .video-container {
        flex: 1;
        background-color: #1a1a1a;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
    }

    .video-feed {
        width: 90%;
        height: 85%;
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        border: 2px solid #333;
        box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
    }

    .placeholder-content {
        text-align: center;
        color: rgba(255,255,255,0.6);
    }

    .optivue-watermark {
        position: absolute;
        top: 15px;
        left: 15px;
        color: rgba(255,255,255,0.5);
        font-size: 18px;
        font-weight: bold;
        letter-spacing: 1px;
    }

    .camera-info {
        position: absolute;
        top: 15px;
        right: 15px;
        background-color: rgba(0,0,0,0.7);
        color: #fff;
        padding: 8px 12px;
        border-radius: 3px;
        font-size: 11px;
        font-family: monospace;
    }

    .placeholder-icon {
        font-size: 72px;
        margin-bottom: 20px;
        opacity: 0.3;
    }

    .placeholder-text {
        font-size: 16px;
        margin-bottom: 10px;
    }

    .placeholder-subtext {
        font-size: 12px;
        opacity: 0.7;
    }

    /* Control Bar at Bottom */
    .control-bar {
        background: linear-gradient(to bottom, #e8e8e8 0%, #d0d0d0 100%);
        height: 70px;
        border-top: 1px solid #bbb;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        padding: 0 20px;
        box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
    }

    .control-button {
        background: linear-gradient(to bottom, #f9f9f9 0%, #e0e0e0 100%);
        border: 1px solid #999;
        border-radius: 4px;
        padding: 8px 16px;
        font-size: 12px;
        color: #333;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        min-width: 70px;
        transition: all 0.2s;
        box-shadow: 0 1px 3px rgba(0,0,0,0.15);
    }

    .control-button:hover {
        background: linear-gradient(to bottom, #fff 0%, #e8e8e8 100%);
        border-color: #666;
    }

    .control-button:active {
        background: linear-gradient(to bottom, #d5d5d5 0%, #c5c5c5 100%);
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
    }

    .button-icon {
        font-size: 20px;
    }

    .button-label {
        font-size: 11px;
        font-weight: 600;
    }

    .separator {
        width: 1px;
        height: 50px;
        background-color: #999;
    }

    /* Side Panel (optional, collapsed by default) */
    .side-panel {
        width: 0;
        background-color: #fff;
        border-left: 1px solid #ccc;
        overflow: hidden;
        transition: width 0.3s;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .control-bar {
            gap: 10px;
            padding: 0 10px;
        }
        
        .control-button {
            min-width: 60px;
            padding: 6px 10px;
        }

        .video-feed {
            width: 95%;
            height: 90%;
        }
    }
</style>

{% block content %}

<div class="video-container">
    <div class="video-feed">
        <!-- OptiVue Watermark -->
        <div class="optivue-watermark">OptiVue</div>
        
        <!-- Camera Info Overlay -->
        <div class="camera-info">
            {{ camera_name|default('Camera 1') }}<br>
            {{ camera_ip|default('192.168.1.100') }}
        </div>
        
        <!-- Placeholder Content (replace with actual MJPEG stream) -->
        <div class="placeholder-content">
            <div class="placeholder-icon">üìπ</div>
            <div class="placeholder-text">Live Video Stream</div>
            <div class="placeholder-subtext">MJPEG stream placeholder ‚Ä¢ {{ resolution|default('640x480') }} @ {{ framerate|default('30') }}fps</div>
        </div>
    </div>
</div>

<div class="side-panel"></div>

<!-- Control Bar -->
<div class="control-bar">
    <button class="control-button" id="playBtn">
        <span class="button-icon">‚ñ∂Ô∏è</span>
        <span class="button-label">Play</span>
    </button>
    
    <button class="control-button" id="pauseBtn">
        <span class="button-icon">‚è∏Ô∏è</span>
        <span class="button-label">Pause</span>
    </button>
    
    <button class="control-button" id="stopBtn">
        <span class="button-icon">‚èπÔ∏è</span>
        <span class="button-label">Stop</span>
    </button>
    
    <div class="separator"></div>
    
    <button class="control-button" id="snapshotBtn">
        <span class="button-icon">üì∏</span>
        <span class="button-label">Snapshot</span>
    </button>
    
    <button class="control-button" id="recordBtn">
        <span class="button-icon">‚è∫Ô∏è</span>
        <span class="button-label">Record</span>
    </button>
    
    <div class="separator"></div>
    
    <button class="control-button" id="zoomInBtn">
        <span class="button-icon">üîç</span>
        <span class="button-label">Zoom In</span>
    </button>
    
    <button class="control-button" id="zoomOutBtn">
        <span class="button-icon">üîé</span>
        <span class="button-label">Zoom Out</span>
    </button>
    
    <div class="separator"></div>
    
    <button class="control-button" id="settingsBtn">
        <span class="button-icon">‚öôÔ∏è</span>
        <span class="button-label">Settings</span>
    </button>
    
    <button class="control-button" id="infoBtn">
        <span class="button-icon">‚ÑπÔ∏è</span>
        <span class="button-label">Info</span>
    </button>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Add button click handlers
    document.querySelectorAll('.control-button').forEach(button => {
        button.addEventListener('click', function() {
            const label = this.querySelector('.button-label').textContent;
            console.log(`${label} button clicked`);
            
            // Add your button logic here
            // For example, send commands to your backend:
            // fetch(`/api/camera/${label.toLowerCase().replace(' ', '-')}`)
        });
    });

    // Example: Replace placeholder with actual MJPEG stream
    // Uncomment and modify when ready to integrate your stream
    /*
    window.addEventListener('DOMContentLoaded', function() {
        const videoFeed = document.querySelector('.video-feed');
        const placeholder = document.querySelector('.placeholder-content');
        
        // Create img element for MJPEG stream
        const streamImg = document.createElement('img');
        streamImg.src = '/stream'; // Your MJPEG stream endpoint
        streamImg.style.width = '100%';
        streamImg.style.height = '100%';
        streamImg.style.objectFit = 'contain';
        
        // Replace placeholder with stream
        placeholder.style.display = 'none';
        videoFeed.appendChild(streamImg);
    });
    */
</script>
{% endblock %}